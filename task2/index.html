<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³¼ì œ 2: ê°œì¸ì •ë³´ ë§ˆìŠ¤í‚¹ ë„êµ¬</title>
    <style>
        /* ì „ì²´ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        /* íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ */
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            background: #f8f9ff;
            transition: all 0.3s;
            cursor: pointer;
        }

        .upload-area:hover {
            background: #eef1ff;
            border-color: #764ba2;
        }

        .upload-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        #fileInput {
            display: none;
        }

        .file-label {
            display: inline-block;
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .file-label:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* ë§ˆìŠ¤í‚¹ ê·œì¹™ ì„¤ëª… */
        .masking-rules {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .masking-rules h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .masking-rules ul {
            list-style: none;
            padding: 0;
        }

        .masking-rules li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .masking-rules li:last-child {
            border-bottom: none;
        }

        .masking-rules code {
            background: #e0e7ff;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }

        /* ê²°ê³¼ ì˜ì—­ */
        .results {
            display: none;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .result-box {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #667eea;
        }

        .result-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .result-box pre {
            background: white;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
            font-size: 0.9em;
            line-height: 1.6;
        }

        /* í†µê³„ ë°•ìŠ¤ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-box .number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-box .label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê·¸ë¦¬ë“œ */
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .test-button {
            display: block;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            font-size: 1em;
        }

        .test-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .test-button .test-number {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .test-button .test-desc {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* ë©”ì‹œì§€ */
        .message {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .message.error {
            background: #fee;
            color: #c33;
            border: 1px solid #fcc;
        }

        .message.success {
            background: #efe;
            color: #3c3;
            border: 1px solid #cfc;
        }

        .message.info {
            background: #e7f3ff;
            color: #004085;
            border: 1px solid #b8daff;
        }

        /* ë§í¬ ì„¹ì…˜ */
        .links-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #eee;
        }

        .links-section h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .link-button {
            display: block;
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .link-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .link-button.current {
            background: #333;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            .result-comparison {
                grid-template-columns: 1fr;
            }

            .test-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <h1>ğŸ”’ ê³¼ì œ 2: ê°œì¸ì •ë³´ ë§ˆìŠ¤í‚¹ ë„êµ¬</h1>
        <p class="subtitle">ê°œì¸ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ íƒì§€í•˜ê³  ì•ˆì „í•˜ê²Œ ë§ˆìŠ¤í‚¹ ì²˜ë¦¬í•©ë‹ˆë‹¤</p>

        <!-- ë©”ì‹œì§€ ì˜ì—­ -->
        <div id="messageArea" class="message"></div>

        <!-- ë§ˆìŠ¤í‚¹ ê·œì¹™ ì„¤ëª… -->
        <div class="masking-rules">
            <h3>ğŸ“‹ ë§ˆìŠ¤í‚¹ ê·œì¹™</h3>
            <ul>
                <li>ğŸ†” ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸: ë’·ìë¦¬ ì „ì²´ ë§ˆìŠ¤í‚¹ <code>123456-1*******</code></li>
                <li>ğŸ“± ì „í™”ë²ˆí˜¸: ì¤‘ê°„ 4ìë¦¬ ë§ˆìŠ¤í‚¹ <code>010-****-5678</code></li>
                <li>ğŸ“§ ì´ë©”ì¼: @ ì• ë¶€ë¶„ 50% ë§ˆìŠ¤í‚¹ <code>chu****@gov.kr</code></li>
                <li>ğŸ  ì£¼ì†Œ: ìƒì„¸ì£¼ì†Œ ë§ˆìŠ¤í‚¹ <code>ì„œìš¸ì‹œ ì¢…ë¡œêµ¬ ****</code></li>
                <li>ğŸ’³ ì‹ ìš©ì¹´ë“œ: ì¤‘ê°„ 8ìë¦¬ ë§ˆìŠ¤í‚¹ <code>1234-****-****-5678</code></li>
            </ul>
        </div>

        <!-- íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ -->
        <div class="section">
            <h2>ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ</h2>
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ”</div>
                <p style="font-size: 1.2em; color: #667eea; margin-bottom: 10px;">
                    ê°œì¸ì •ë³´ê°€ í¬í•¨ëœ í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”
                </p>
                <p style="color: #999; font-size: 0.9em;">(.txt íŒŒì¼ë§Œ ì§€ì›)</p>
                <label for="fileInput" class="file-label">íŒŒì¼ ì„ íƒ</label>
                <input type="file" id="fileInput" accept=".txt" />
            </div>
        </div>

        <!-- ê²°ê³¼ ì˜ì—­ -->
        <div class="results" id="results">
            <h2>ğŸ“Š ë§ˆìŠ¤í‚¹ ê²°ê³¼</h2>

            <!-- í†µê³„ -->
            <div class="stats-grid" id="statsGrid">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>

            <!-- ì›ë³¸/ë§ˆìŠ¤í‚¹ ë¹„êµ -->
            <div class="result-comparison">
                <div class="result-box">
                    <h3>ğŸ“„ ì›ë³¸ í…ìŠ¤íŠ¸</h3>
                    <pre id="originalText"></pre>
                </div>
                <div class="result-box">
                    <h3>ğŸ”’ ë§ˆìŠ¤í‚¹ëœ í…ìŠ¤íŠ¸</h3>
                    <pre id="maskedText"></pre>
                </div>
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ -->
        <div class="section">
            <h2>ğŸ§ª í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤</h2>
            <p style="margin-bottom: 20px; color: #666;">
                ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”. ê° ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
            <div class="test-grid">
                <button class="test-button" onclick="runTest(1)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 1</div>
                    <div class="test-desc">ì£¼ë¯¼ë²ˆí˜¸ ë§ˆìŠ¤í‚¹</div>
                </button>
                <button class="test-button" onclick="runTest(2)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 2</div>
                    <div class="test-desc">ì „í™”ë²ˆí˜¸ ë§ˆìŠ¤í‚¹</div>
                </button>
                <button class="test-button" onclick="runTest(3)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 3</div>
                    <div class="test-desc">ì´ë©”ì¼ ë§ˆìŠ¤í‚¹</div>
                </button>
                <button class="test-button" onclick="runTest(4)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 4</div>
                    <div class="test-desc">ì‹ ìš©ì¹´ë“œ ë§ˆìŠ¤í‚¹</div>
                </button>
                <button class="test-button" onclick="runTest(5)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 5</div>
                    <div class="test-desc">ì£¼ì†Œ ë§ˆìŠ¤í‚¹</div>
                </button>
                <button class="test-button" onclick="runTest(6)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 6</div>
                    <div class="test-desc">í˜¼í•© ì •ë³´</div>
                </button>
                <button class="test-button" onclick="runTest(7)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 7</div>
                    <div class="test-desc">í•˜ì´í”ˆ ì—†ëŠ” í˜•ì‹</div>
                </button>
                <button class="test-button" onclick="runTest(8)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 8</div>
                    <div class="test-desc">ë¹ˆ íŒŒì¼</div>
                </button>
                <button class="test-button" onclick="runTest(9)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 9</div>
                    <div class="test-desc">ê°œì¸ì •ë³´ ì—†ìŒ</div>
                </button>
                <button class="test-button" onclick="runTest(10)">
                    <div class="test-number">í…ŒìŠ¤íŠ¸ 10</div>
                    <div class="test-desc">ëŒ€ëŸ‰ ë°ì´í„°</div>
                </button>
            </div>
        </div>

        <!-- ë‹¤ë¥¸ ê³¼ì œ ë§í¬ -->
        <div class="links-section">
            <h3>ğŸ”— ë‹¤ë¥¸ ê³¼ì œ ë°”ë¡œê°€ê¸°</h3>
            <div class="links-grid">
                <a href="../task1/index.html" class="link-button">ê³¼ì œ 1</a>
                <a href="index.html" class="link-button current">ê³¼ì œ 2</a>
                <a href="../task3/index.html" class="link-button">ê³¼ì œ 3</a>
                <a href="../task4/index.html" class="link-button">ê³¼ì œ 4</a>
                <a href="../task5/index.html" class="link-button">ê³¼ì œ 5</a>
                <a href="../task6/index.html" class="link-button">ê³¼ì œ 6</a>
                <a href="../task7/index.html" class="link-button">ê³¼ì œ 7</a>
                <a href="../task8/index.html" class="link-button">ê³¼ì œ 8</a>
                <a href="../task9/index.html" class="link-button">ê³¼ì œ 9</a>
                <a href="../task10/index.html" class="link-button">ê³¼ì œ 10</a>
            </div>
        </div>
    </div>

    <script>
        // DOM ìš”ì†Œ
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const messageArea = document.getElementById('messageArea');
        const results = document.getElementById('results');
        const originalText = document.getElementById('originalText');
        const maskedText = document.getElementById('maskedText');
        const statsGrid = document.getElementById('statsGrid');

        /**
         * ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
         */
        function showMessage(message, type = 'info') {
            messageArea.textContent = message;
            messageArea.className = `message ${type}`;
            messageArea.style.display = 'block';
            setTimeout(() => {
                messageArea.style.display = 'none';
            }, 3000);
        }

        /**
         * ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ë§ˆìŠ¤í‚¹
         */
        function maskResidentNumber(text) {
            let count = 0;
            // í•˜ì´í”ˆ ìˆëŠ” ê²½ìš°
            text = text.replace(/\b(\d{6})-(\d{7})\b/g, (match, p1, p2) => {
                count++;
                return `${p1}-${p2[0]}${'*'.repeat(6)}`;
            });
            // í•˜ì´í”ˆ ì—†ëŠ” ê²½ìš°
            text = text.replace(/(?<!\d)(\d{6})(\d{7})(?!\d)/g, (match, p1, p2) => {
                count++;
                return `${p1}${p2[0]}${'*'.repeat(6)}`;
            });
            return { text, count };
        }

        /**
         * ì „í™”ë²ˆí˜¸ ë§ˆìŠ¤í‚¹
         */
        function maskPhoneNumber(text) {
            let count = 0;
            // íœ´ëŒ€í° (í•˜ì´í”ˆ ìˆìŒ)
            text = text.replace(/\b(01[0-9])-(\d{3,4})-(\d{4})\b/g, (match, p1, p2, p3) => {
                count++;
                return `${p1}-${'*'.repeat(p2.length)}-${p3}`;
            });
            // íœ´ëŒ€í° (í•˜ì´í”ˆ ì—†ìŒ)
            text = text.replace(/\b(01[0-9])(\d{3,4})(\d{4})\b/g, (match, p1, p2, p3) => {
                count++;
                return `${p1}${'*'.repeat(p2.length)}${p3}`;
            });
            // ì¼ë°˜ ì „í™”
            text = text.replace(/\b(0\d{1,2})-(\d{3,4})-(\d{4})\b/g, (match, p1, p2, p3) => {
                count++;
                return `${p1}-${'*'.repeat(p2.length)}-${p3}`;
            });
            return { text, count };
        }

        /**
         * ì´ë©”ì¼ ë§ˆìŠ¤í‚¹
         */
        function maskEmail(text) {
            let count = 0;
            text = text.replace(/\b([a-zA-Z0-9._-]+)@([a-zA-Z0-9.-]+\.[a-zA-Z]{2,})\b/g, (match, username, domain) => {
                count++;
                const visibleLength = Math.max(1, Math.floor(username.length / 2));
                const masked = username.substring(0, visibleLength) + '*'.repeat(username.length - visibleLength);
                return `${masked}@${domain}`;
            });
            return { text, count };
        }

        /**
         * ì‹ ìš©ì¹´ë“œ ë§ˆìŠ¤í‚¹
         */
        function maskCreditCard(text) {
            let count = 0;
            // í•˜ì´í”ˆ ìˆìŒ
            text = text.replace(/\b(\d{4})-(\d{4})-(\d{4})-(\d{4})\b/g, (match, p1, p2, p3, p4) => {
                count++;
                return `${p1}-****-****-${p4}`;
            });
            // í•˜ì´í”ˆ ì—†ìŒ (16ìë¦¬)
            text = text.replace(/(?<!\d)(\d{4})(\d{4})(\d{4})(\d{4})(?!\d)/g, (match, p1, p2, p3, p4) => {
                count++;
                return `${p1}********${p4}`;
            });
            return { text, count };
        }

        /**
         * ì£¼ì†Œ ë§ˆìŠ¤í‚¹
         */
        function maskAddress(text) {
            let count = 0;
            // ì „ì²´ ì£¼ì†Œ íŒ¨í„´
            const pattern1 = /(ì„œìš¸íŠ¹ë³„ì‹œ|ì„œìš¸ì‹œ|ì„œìš¸|ë¶€ì‚°ê´‘ì—­ì‹œ|ë¶€ì‚°ì‹œ|ë¶€ì‚°|ëŒ€êµ¬ê´‘ì—­ì‹œ|ëŒ€êµ¬ì‹œ|ëŒ€êµ¬|ì¸ì²œê´‘ì—­ì‹œ|ì¸ì²œì‹œ|ì¸ì²œ|ê´‘ì£¼ê´‘ì—­ì‹œ|ê´‘ì£¼ì‹œ|ê´‘ì£¼|ëŒ€ì „ê´‘ì—­ì‹œ|ëŒ€ì „ì‹œ|ëŒ€ì „|ìš¸ì‚°ê´‘ì—­ì‹œ|ìš¸ì‚°ì‹œ|ìš¸ì‚°|ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ|ì„¸ì¢…ì‹œ|ì„¸ì¢…|ê²½ê¸°ë„|ê°•ì›ë„|ì¶©ì²­ë¶ë„|ì¶©ë¶|ì¶©ì²­ë‚¨ë„|ì¶©ë‚¨|ì „ë¼ë¶ë„|ì „ë¶|ì „ë¼ë‚¨ë„|ì „ë‚¨|ê²½ìƒë¶ë„|ê²½ë¶|ê²½ìƒë‚¨ë„|ê²½ë‚¨|ì œì£¼íŠ¹ë³„ìì¹˜ë„|ì œì£¼ë„|ì œì£¼)\s+([ê°€-í£]+(?:êµ¬|êµ°))\s+([ê°€-í£0-9\s]+(?:ë¡œ|ê¸¸|ëŒ€ë¡œ|ë²ˆê¸¸|ê°€|ë™|ë¦¬)[0-9\s-]*[ê°€-í£0-9]*)/g;
            text = text.replace(pattern1, (match, p1, p2, p3) => {
                count++;
                return `${p1} ${p2} ****`;
            });
            // ê°„ë‹¨í•œ ì£¼ì†Œ íŒ¨í„´
            const pattern2 = /([ê°€-í£]+(?:êµ¬|êµ°))\s+([ê°€-í£]+ë™)\s+([0-9-]+(?:ë²ˆì§€|ë²ˆ)?)/g;
            text = text.replace(pattern2, (match, p1, p2, p3) => {
                count++;
                return `${p1} ${p2} ****`;
            });
            return { text, count };
        }

        /**
         * ëª¨ë“  ê°œì¸ì •ë³´ ë§ˆìŠ¤í‚¹
         */
        function maskAllPersonalInfo(text) {
            const stats = {
                resident_number: 0,
                phone_number: 0,
                email: 0,
                address: 0,
                credit_card: 0
            };

            // ìˆœì„œ ì¤‘ìš”: ë” êµ¬ì²´ì ì¸ íŒ¨í„´ì„ ë¨¼ì €
            let result = maskResidentNumber(text);
            text = result.text;
            stats.resident_number = result.count;

            result = maskCreditCard(text);
            text = result.text;
            stats.credit_card = result.count;

            result = maskPhoneNumber(text);
            text = result.text;
            stats.phone_number = result.count;

            result = maskEmail(text);
            text = result.text;
            stats.email = result.count;

            result = maskAddress(text);
            text = result.text;
            stats.address = result.count;

            return { text, stats };
        }

        /**
         * í†µê³„ í‘œì‹œ
         */
        function displayStats(stats) {
            const items = [
                { label: 'ì£¼ë¯¼ë²ˆí˜¸', count: stats.resident_number, icon: 'ğŸ†”' },
                { label: 'ì „í™”ë²ˆí˜¸', count: stats.phone_number, icon: 'ğŸ“±' },
                { label: 'ì´ë©”ì¼', count: stats.email, icon: 'ğŸ“§' },
                { label: 'ì£¼ì†Œ', count: stats.address, icon: 'ğŸ ' },
                { label: 'ì‹ ìš©ì¹´ë“œ', count: stats.credit_card, icon: 'ğŸ’³' }
            ];

            statsGrid.innerHTML = items.map(item => `
                <div class="stat-box">
                    <div class="number">${item.icon} ${item.count}</div>
                    <div class="label">${item.label}</div>
                </div>
            `).join('');
        }

        /**
         * íŒŒì¼ ì²˜ë¦¬
         */
        function processFile(file) {
            if (!file) {
                showMessage('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            if (!file.name.endsWith('.txt')) {
                showMessage('ì˜ëª»ëœ íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. .txt íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
                return;
            }

            const reader = new FileReader();

            reader.onload = function(e) {
                const content = e.target.result;

                if (!content.trim()) {
                    showMessage('ë¹ˆ íŒŒì¼ì…ë‹ˆë‹¤', 'error');
                    results.style.display = 'none';
                    return;
                }

                const result = maskAllPersonalInfo(content);
                const total = Object.values(result.stats).reduce((a, b) => a + b, 0);

                if (total === 0) {
                    showMessage('íƒì§€ëœ ê°œì¸ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤', 'info');
                } else {
                    showMessage(`ì´ ${total}ê°œì˜ ê°œì¸ì •ë³´ê°€ íƒì§€ë˜ì—ˆìŠµë‹ˆë‹¤`, 'success');
                }

                originalText.textContent = content;
                maskedText.textContent = result.text;
                displayStats(result.stats);
                results.style.display = 'block';
            };

            reader.onerror = function() {
                showMessage('íŒŒì¼ ì½ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            };

            reader.readAsText(file, 'UTF-8');
        }

        /**
         * í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰
         */
        function runTest(testNumber) {
            const testFile = `test_case${testNumber}.txt`;

            fetch(testFile)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    }
                    return response.text();
                })
                .then(content => {
                    if (!content.trim()) {
                        showMessage('ë¹ˆ íŒŒì¼ì…ë‹ˆë‹¤', 'error');
                        results.style.display = 'none';
                        return;
                    }

                    const result = maskAllPersonalInfo(content);
                    const total = Object.values(result.stats).reduce((a, b) => a + b, 0);

                    if (total === 0) {
                        showMessage(`í…ŒìŠ¤íŠ¸ ${testNumber}: íƒì§€ëœ ê°œì¸ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤`, 'info');
                    } else {
                        showMessage(`í…ŒìŠ¤íŠ¸ ${testNumber}: ${total}ê°œì˜ ê°œì¸ì •ë³´ê°€ íƒì§€ë˜ì—ˆìŠµë‹ˆë‹¤`, 'success');
                    }

                    originalText.textContent = content;
                    maskedText.textContent = result.text;
                    displayStats(result.stats);
                    results.style.display = 'block';

                    // ê²°ê³¼ë¡œ ìŠ¤í¬ë¡¤
                    results.scrollIntoView({ behavior: 'smooth' });
                })
                .catch(error => {
                    showMessage(`í…ŒìŠ¤íŠ¸ ${testNumber} ì‹¤í–‰ ì‹¤íŒ¨: ${error.message}`, 'error');
                });
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            processFile(file);
        });

        uploadArea.addEventListener('click', function() {
            fileInput.click();
        });

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­
        uploadArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            uploadArea.style.background = '#e0e7ff';
        });

        uploadArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            uploadArea.style.background = '#f8f9ff';
        });

        uploadArea.addEventListener('drop', function(e) {
            e.preventDefault();
            uploadArea.style.background = '#f8f9ff';
            const file = e.dataTransfer.files[0];
            processFile(file);
        });
    </script>
</body>
</html>
